<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Dashboard - Student Performance Analytics</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand">
            <i data-lucide="graduation-cap"></i>
            <span>Edu Track - Student Portal</span>
        </div>
        <div class="nav-links">
            <button class="btn btn-outline" onclick="navigateTo('student_login.html')">Switch Student</button>
            <button class="btn btn-outline" onclick="navigateTo('index.html')">Home</button>
        </div>
    </nav>

    <div class="container">
        <div class="dashboard-header">
            <h1>Welcome, <span id="studentName">Student</span>!</h1>
            <p>Here's your academic performance overview</p>
        </div>

        <!-- Performance Overview - Dynamically created by JavaScript -->
        <div id="performanceOverview" class="dashboard-section">
            <h2>Performance Overview</h2>
            <!-- Content will be populated by JavaScript -->
        </div>

        <!-- Subject Performance - Dynamically created by JavaScript -->
        <div id="subjectPerformance" class="dashboard-section">
            <h2>Subject Performance</h2>
            <!-- Content will be populated by JavaScript -->
        </div>

        <!-- Recent Progress - Dynamically created by JavaScript -->
        <div id="recentProgress" class="dashboard-section">
            <h2>Recent Progress</h2>
            <!-- Content will be populated by JavaScript -->
        </div>

        <!-- Action Buttons -->
        <div class="dashboard-grid">
            <div class="dashboard-card" onclick="viewDetailedReport()">
                <div class="card-icon">
                    <i data-lucide="file-text"></i>
                </div>
                <h3>View Detailed Report</h3>
                <p>Complete performance analysis with interactive charts</p>
            </div>

            <div class="dashboard-card" onclick="downloadPDF()">
                <div class="card-icon">
                    <i data-lucide="download"></i>
                </div>
                <h3>Download PDF Report</h3>
                <p>Get your complete academic report as PDF</p>
            </div>

            <div class="dashboard-card" onclick="navigateTo('subject_improvement.html')">
                <div class="card-icon">
                    <i data-lucide="target"></i>
                </div>
                <h3>Improvement Tips</h3>
                <p>Personalized study recommendations</p>
            </div>

            <div class="dashboard-card" onclick="navigateTo('analytics_dashboard.html')">
                <div class="card-icon">
                    <i data-lucide="bar-chart-3"></i>
                </div>
                <h3>Advanced Analytics</h3>
                <p>Explore detailed performance analytics</p>
            </div>

            <div class="dashboard-card" onclick="logout()">
                <div class="card-icon">
                    <i data-lucide="log-out"></i>
                </div>
                <h3>Logout</h3>
                <p>Sign out of your account</p>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons();

            // Ensure sample data exists and set default student
            generateSampleData();

            // Check if student is logged in
            let selectedStudentId = localStorage.getItem('selectedStudentId');
            const currentStudent = localStorage.getItem('currentStudent');

            if (!selectedStudentId && !currentStudent) {
                // For demo purposes, set a default student if none is selected
                const students = getStudents();
                if (students.length > 0) {
                    selectedStudentId = students[0].id; // Use first available student
                    localStorage.setItem('selectedStudentId', selectedStudentId);
                    console.log('No student selected, using first available student:', selectedStudentId);
                } else {
                    console.error('No students available in database');
                    showAlert('No student data available. Please contact administrator.', 'error');
                    return;
                }
            }

            // Load the dashboard
            try {
                loadStudentDashboard();
            } catch (error) {
                console.error('Error loading student dashboard:', error);
                showAlert('Error loading dashboard. Please try again.', 'error');
            }
        });

        function viewDetailedReport() {
            navigateTo('view_report.html');
        }
    </script>
</body>
</html>